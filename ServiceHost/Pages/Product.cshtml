@page "{id}"
@model ServiceHost.Pages.ProductModel
@{ ViewData["Title"] = Model.Product.Name;
                ViewData["keywords"] = Model.Product.Keywords;
                ViewData["metaDescription"] = Model.Product.MetaDescription; }
<main class="main">
    <div class="page-header breadcrumb-wrap">
        <div class="container">
            <div class="breadcrumb">
                <a asp-page="./Index" rel="nofollow">صفحه اصلی<i class="fi-rs-home mr-5"></i></a>
                <span></span> @Model.Product.Name
            </div>
        </div>
    </div>

    <div class="container mb-30">
        <div class="row">
            <div class="col-xl-10 col-lg-12 m-auto">
                <div class="product-detail accordion-detail">
                    <div class="row mb-50 mt-30">
                        <!-- گالری -->
                        <div class="col-md-6">
                            <div class="detail-gallery">
                                <span class="zoom-icon"><i class="fi-rs-search"></i></span>
                                <div class="product-image-slider">
                                    <figure class="border-radius-10">
                                        <div>
                                            <img src="~/ProductPictures/@(string.IsNullOrWhiteSpace(Model.Product.Picture) ? "no-image.png" : Model.Product.Picture)"
                                                 alt="@Model.Product.PictureAlt"
                                                 title="@Model.Product.PictureTitle" />
                                        </div>
                                    </figure>
                                </div>
                                <div class="slider-nav-thumbnails">
                                    @foreach (var picture in Model.Product.Pictures)
                                    {
                                        var picPath = string.IsNullOrWhiteSpace(picture.Picture) ? "no-image.png" : picture.Picture;
                        <div>
                            <img src="~/ProductPictures/@picPath"
                                 alt="@picture.PictureAlt"
                                 title="@picture.PictureTitle" />
                        </div>}
                                </div>
                            </div>
                        </div>

                        <!-- جزئیات محصول -->
                        <div class="col-md-6">
                            <div class="detail-info pr-30 pl-30">
                                @if (Model.Product.HasDiscount)
                                {
                    <span class="stock-status out-stock">دارای تخفیف</span>}
                                <h2 class="title-detail">@Model.Product.Name</h2>

                                <div class="clearfix product-price-cover">
                                    <div class="product-price primary-color float-left">
                                        @if (Model.Product.HasDiscount)
                                        {
                            <span class="current-price text-brand">@Model.Product.PriceWithDiscount تومان</span>
                                            <span>
                                                <span class="save-price font-md color3 ml-15">@Model.Product.DiscountRate% تخفیف</span>
                                                <span class="old-price font-md ml-15">@Model.Product.Price تومان</span>
                                            </span> }
                                                        else
                                                        {
                                            <span class="current-price text-brand">@Model.Product.Price تومان</span>}
                                    </div>
                                </div>

                                <div class="short-desc mb-30">
                                    <p class="font-lg">@Model.Product.ShortDescription</p>
                                </div>

                                <div class="detail-extralink mb-50">
                                    <div>
                                        <input type="number" class="qty-val" min="0.5" step="0.1" max="100" value="1.0" id="productCount">
                                        <span>متر مربع</span>
                                    </div>

                                    <div class="product-extra-link2">
                                        <button type="button" class="button button-add-to-cart"
                                                onclick="addToCart('@Model.Product.Id','@Model.Product.Name','@Model.Product.DoublePrice','@Model.Product.Picture')">
                                            <i class="fi-rs-shopping-cart"></i> افزودن به سبد خرید
                                        </button>
                                    </div>
                                </div>
                                <small id="qtyMsg" style="color:red;display:none;"></small>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</main>

<!-- JS کنترل مقدار سفارش -->
<script>
    const input = document.getElementById("productCount");
    const msg = document.getElementById("qtyMsg");

    input.addEventListener("input", function () {
        const min = parseFloat(this.min);
        const max = parseFloat(this.max);
        const value = parseFloat(this.value);

        if (isNaN(value)) {
            msg.textContent = "لطفاً مقدار سفارش را وارد کنید.";
            msg.style.display = "inline";
            return;
        }

        if (value < min) {
            msg.textContent = `حداقل مقدار سفارش ${min} متر مربع است.`;
            msg.style.display = "inline";
            this.value = min;
        } else if (value > max) {
            msg.textContent = `حداکثر مقدار سفارش ${max} متر مربع است.`;
            msg.style.display = "inline";
            this.value = max;
        } else {
            msg.style.display = "none";
        }
    });
</script>